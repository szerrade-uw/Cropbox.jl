<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Lotka-Volterra · Cropbox.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://junhyukjeon.github.io/Cropbox.jl/stable/tutorials/lotkavolterra/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Cropbox.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Cropbox.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../../">Cropbox</a></li><li><a class="tocitem" href="../../installation/">Installation</a></li></ul></li><li><span class="tocitem">Guide</span><ul><li><a class="tocitem" href="../../guide/system/">System</a></li><li><a class="tocitem" href="../../guide/variable/">Variable</a></li><li><a class="tocitem" href="../../guide/configuration/">Configuration</a></li><li><a class="tocitem" href="../../guide/simulation/">Simulation</a></li><li><a class="tocitem" href="../../guide/visualization/">Visualization</a></li><li><a class="tocitem" href="../../guide/inspection/">Inspection</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../gdd/">Growing Degree-Day</a></li><li class="is-active"><a class="tocitem" href>Lotka-Volterra</a><ul class="internal"><li><a class="tocitem" href="#Density-Dependent-Lotka-Volterra-Equations"><span>Density-Dependent Lotka-Volterra Equations</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../gallery/">Gallery</a></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../../reference/">Index</a></li><li><a class="tocitem" href="../../reference/declaration/">Declaration</a></li><li><a class="tocitem" href="../../reference/simulation/">Simulation</a></li><li><a class="tocitem" href="../../reference/visualization/">Visualization</a></li><li><a class="tocitem" href="../../reference/inspection/">Inspection</a></li></ul></li><li><a class="tocitem" href="../../faq/">Frequently Asked Questions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Lotka-Volterra</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Lotka-Volterra</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/junhyukjeon/Cropbox.jl/blob/documentation/docs/src/tutorials/lotkavolterra.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Lotka-Volterra-Equations"><a class="docs-heading-anchor" href="#Lotka-Volterra-Equations">Lotka-Volterra Equations</a><a id="Lotka-Volterra-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Lotka-Volterra-Equations" title="Permalink"></a></h1><p>In this tutorial, we will create a model that simulates population dynamics between prey and predator using the Lotka-Volterra equations. The Lotka-Volterra equations are as follows:</p><p class="math-container">\[\begin{align}
\frac{dN}{dt} &amp;= bN - aNP \\
\frac{dP}{dt} &amp;= caNP - mP \\
\end{align}\]</p><p><br/> Here is a list of variables used in the system:</p><table><tr><th style="text-align: center">Symbol</th><th style="text-align: center">Value</th><th style="text-align: center">Units</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: center">t</td><td style="text-align: center">-</td><td style="text-align: center"><span>$\mathrm{yr}$</span></td><td style="text-align: left">Time unit used in the model</td></tr><tr><td style="text-align: center">N</td><td style="text-align: center">-</td><td style="text-align: center">-</td><td style="text-align: left">Prey population as number of individuals (state variable)</td></tr><tr><td style="text-align: center">P</td><td style="text-align: center">-</td><td style="text-align: center">-</td><td style="text-align: left">Predator population as number of individuals (state variable)</td></tr><tr><td style="text-align: center">b</td><td style="text-align: center">-</td><td style="text-align: center"><span>$\mathrm{yr^{-1}}$</span></td><td style="text-align: left">Per capital birth rate that defines the intrinsic growth rate of prey population</td></tr><tr><td style="text-align: center">a</td><td style="text-align: center">-</td><td style="text-align: center"><span>$\mathrm{yr^{-1}}$</span></td><td style="text-align: left">Attack rate or predation rate</td></tr><tr><td style="text-align: center">c</td><td style="text-align: center">-</td><td style="text-align: center">-</td><td style="text-align: left">Conversion efficiency of an eaten prey into new predator; predator&#39;s reproduction efficiency per prey consumed)</td></tr><tr><td style="text-align: center">m</td><td style="text-align: center">-</td><td style="text-align: center"><span>$\mathrm{yr^{-1}}$</span></td><td style="text-align: left">Mortality rate of predator population</td></tr></table><p><br/> Let us begin by creating a <a href="../../guide/system/#System">system</a> called <code>LotkaVolterra</code>. Since this is a system that we want to simulate later on, we must include <a href="../../guide/system/#Controller"><code>Controller</code></a> as a <a href="../../guide/system/#Mixin">mixin</a>.</p><pre><code class="nohighlight hljs">@system LotkaVolterra(Controller)</code></pre><p><br/> We will first declare a time variable with a yearly unit, which we will use for plotting the model simulations later on. Recall that <code>context.clock.time</code> is a variable that keeps track of the progression of time in hourly units. We are simply declaring a variable to keep track of the time in years.</p><pre><code class="nohighlight hljs">@system LotkaVolterra(Controller) begin
    t(context.clock.time) ~ track(u&quot;yr&quot;)
end</code></pre><p><br/> Next, we will declare the parameters in the equations as <code>preserve</code> variables. <code>preserve</code> variables are variables that remain constant throughout a simulation.</p><pre><code class="nohighlight hljs">@system LotkaVolterra(Controller) begin
    t(context.clock.time) ~ track(u&quot;yr&quot;)

    b: prey_birth_rate            ~ preserve(parameter, u&quot;yr^-1&quot;)
    a: predation_rate             ~ preserve(parameter, u&quot;yr^-1&quot;)
    c: predator_reproduction_rate ~ preserve(parameter)
    m: predator_mortality_rate    ~ preserve(parameter, u&quot;yr^-1&quot;)
end</code></pre><p><br/> Now let us declare the prey and predator populations as variables. The Lotka-Volterra equations describe rates of change for the two populations. As we want to track the actual number of the two populations, we will declare the two populations as <code>accumulate</code> variables, which are simply Euler integrations of the two population rates. Note that a variable can be used as its own depending variable.</p><pre><code class="nohighlight hljs">@system LotkaVolterra begin
    t(context.clock.time) ~ track(u&quot;yr&quot;)

    b: prey_birth_rate            ~ preserve(parameter, u&quot;yr^-1&quot;)
    a: predation_rate             ~ preserve(parameter, u&quot;yr^-1&quot;)
    c: predator_reproduction_rate ~ preserve(parameter)
    m: predator_mortality_rate    ~ preserve(parameter, u&quot;yr^-1&quot;)

    N(N, P, b, a):    prey_population     =&gt;     b*N - a*N*P ~ accumulate
    P(N, P, c, a, m): predator_population =&gt; c*a*N*P -   m*P ~ accumulate
end</code></pre><p><br/> By default, <code>accumulate</code> variables initialize at a value of zero. In our current model, that would result in two populations remaining at zero indefinitely. To address this, we will define the initial values for the two <code>accumulate</code> variables using the <code>init</code> tag. We can specify a particular value, or we can also create and reference new parameters representing the two initial populations. We will go with the latter option as it allows us to flexibly change the initial populations with a configuration.</p><pre><code class="language-julia hljs">@system LotkaVolterra(Controller) begin
    t(context.clock.time) ~ track(u&quot;yr&quot;)

    b: prey_birth_rate            ~ preserve(parameter, u&quot;yr^-1&quot;)
    a: predation_rate             ~ preserve(parameter, u&quot;yr^-1&quot;)
    c: predator_reproduction_rate ~ preserve(parameter)
    m: predator_mortality_rate    ~ preserve(parameter, u&quot;yr^-1&quot;)

    N0: prey_initial_population     ~ preserve(parameter)
    P0: predator_initial_population ~ preserve(parameter)

    N(N, P, b, a):    prey_population     =&gt;     b*N - a*N*P ~ accumulate(init=N0)
    P(N, P, c, a, m): predator_population =&gt; c*a*N*P -   m*P ~ accumulate(init=P0)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Main.LotkaVolterra</code></pre><p><br/> <strong>Configuration</strong></p><p>With the system now defined, we will create a <code>Config</code> object to fill or adjust the parameters.</p><p>First, we will change the <code>step</code> variable in the <code>Clock</code> system to <code>1u&quot;d&quot;</code>, which will make the system update at a daily interval. Recall that <code>Clock</code> is a system that is referenced in all systems by default. You can run the model with any timestep.</p><pre><code class="language- hljs">lvc = @config (:Clock =&gt; step =&gt; 1u&quot;d&quot;)</code></pre><p><br/> Next, we will configure the parameters in the <code>LotkaVolterra</code> system that we defined. Note that we can easily combine confgurations by providing multiple elements.</p><pre><code class="language- hljs">lvc = @config (lvc,
    :LotkaVolterra =&gt; (;
        b = 0.6,
        a = 0.02,
        c = 0.5,
        m = 0.5,
        N0 = 20,
        P0 = 30
    )
)</code></pre><p><br/> <strong>Visualization</strong></p><p>Let us visualize the <code>LotkaVolterra</code> system with the configuration that we just created, using the <code>visualize()</code> function. The <code>visualize()</code> function both runs a simulation and plots the resulting DataFrame.</p><pre><code class="language- hljs">visualize(LotkaVolterra, :t, [:N, :P]; config = lvc, stop = 100u&quot;yr&quot;, kind = :line)</code></pre><h2 id="Density-Dependent-Lotka-Volterra-Equations"><a class="docs-heading-anchor" href="#Density-Dependent-Lotka-Volterra-Equations">Density-Dependent Lotka-Volterra Equations</a><a id="Density-Dependent-Lotka-Volterra-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Density-Dependent-Lotka-Volterra-Equations" title="Permalink"></a></h2><p>Now let&#39;s try to make a density-dependent version of the original Lotka-Volterra model which incorporates a new term in the prey population rate. The new variable <em>K</em> represents the carrying capacity of the prey population.</p><p class="math-container">\[\begin{align}
\frac{dN}{dt} &amp;= bN-\frac{b}{K}N^2-aNP \\
\frac{dP}{dt} &amp;= caNP-mP \\
\end{align}\]</p><p>We will call this new system <code>LotkaVolterraDD</code>.</p><pre><code class="nohighlight hljs">@system LotkaVolterraDD(Controller)</code></pre><p><br/> Since we already defined the <code>LotkaVolterra</code> system, which already has most of the variables we require, we can use <code>LotkaVolterra</code> as a mixin for <code>LotkaVolterraDD</code>. This makes our task a lot simpler, as all that remains is to declare the variable <code>K</code> for carrying capacity and redeclare the variable <code>N</code> for prey population. The variable <code>N</code> in the new system will automatically overwrite the <code>N</code> from <code>LotkaVolterra</code>. </p><pre><code class="language-julia hljs">@system LotkaVolterraDD(LotkaVolterra, Controller) begin
    N(N, P, K, b, a): prey_population =&gt; begin
        b*N - b/K*N^2 - a*N*P
    end ~ accumulate(init = N0)

    K: carrying_capacity ~ preserve(parameter)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Main.LotkaVolterraDD</code></pre><p><br/> <strong>Configuration</strong></p><p>Much like the new system, the new configuration can be created by reusing the old configuration. All we need to do is configure the new variable <code>K</code>.</p><pre><code class="language- hljs">lvddc = @config(lvc, (:LotkaVolterraDD =&gt; K =&gt; 1000))</code></pre><p><br/> <strong>Visualization</strong></p><p>Once again, let us visualize the system using the <code>visualize()</code> function.</p><pre><code class="language- hljs">visualize(LotkaVolterraDD, :t, [:N, :P]; config = lvddc, stop = 100u&quot;yr&quot;, kind = :line)</code></pre><p><strong>Calibration</strong></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../gdd/">« Growing Degree-Day</a><a class="docs-footer-nextpage" href="../../gallery/">Gallery »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 29 December 2022 01:31">Thursday 29 December 2022</span>. Using Julia version 1.8.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
